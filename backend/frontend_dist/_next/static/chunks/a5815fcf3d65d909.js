(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9165,e=>{"use strict";let t=e.i(47167).default.env.NEXT_PUBLIC_API_URL||"/api",s=new class{token=null;constructor(){this.token=localStorage.getItem("demet_token")}setToken(e){this.token=e,localStorage.setItem("demet_token",e)}clearToken(){this.token=null,localStorage.removeItem("demet_token")}async request(e,s={}){let a={...s.headers};s.body instanceof FormData||(a["Content-Type"]=a["Content-Type"]||"application/json"),this.token&&(a.Authorization=`Bearer ${this.token}`);let r=await fetch(`${t}${e}`,{...s,headers:a});if(401===r.status)throw this.clearToken(),window.location.href="/login",Error("Oturum sÃ¼resi doldu");if(!r.ok)throw Error((await r.json().catch(()=>({detail:"Sunucu hatasÄ±"}))).detail||"Ä°stek baÅŸarÄ±sÄ±z");return r.json()}async login(e,t){let s=await this.request("/auth/login",{method:"POST",body:JSON.stringify({username:e,password:t})});return this.setToken(s.access_token),s}async register(e,t,s){let a=await this.request("/auth/register",{method:"POST",body:JSON.stringify({username:e,email:t,password:s})});return this.setToken(a.access_token),a}getInstagramConnectUrl(){return`${t}/auth/instagram/connect`}async getDashboardStats(){return this.request("/dashboard/stats")}async getRecentActivity(e=20){return this.request(`/dashboard/activity?limit=${e}`)}async getAccounts(){return this.request("/accounts")}async getAccount(e){return this.request(`/accounts/${e}`)}async updateAccount(e,t){return this.request(`/accounts/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteAccount(e){return this.request(`/accounts/${e}`,{method:"DELETE"})}async getPosts(e){let t=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/posts${t}`)}async getCalendar(e,t,s){let a=new URLSearchParams({month:String(e),year:String(t)});return s&&a.set("account_id",String(s)),this.request(`/posts/calendar?${a}`)}async createPost(e){return this.request("/posts",{method:"POST",body:JSON.stringify(e)})}async updatePost(e,t){return this.request(`/posts/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deletePost(e){return this.request(`/posts/${e}`,{method:"DELETE"})}async publishPost(e){return this.request(`/posts/${e}/publish`,{method:"POST"})}async getMedia(e){let t=e?"?"+new URLSearchParams(e).toString():"";return this.request(`/media${t}`)}async uploadMedia(e,s="photo",a="default",r){let n=new FormData;e.forEach(e=>n.append("files",e)),n.append("media_type",s),n.append("folder",a),r&&n.append("account_id",String(r));let i={};this.token&&(i.Authorization=`Bearer ${this.token}`);let l=await fetch(`${t}/media/upload`,{method:"POST",headers:i,body:n});if(!l.ok)throw Error("YÃ¼kleme baÅŸarÄ±sÄ±z");return l.json()}async resizeMedia(e,t){return this.request(`/media/${e}/resize?aspect_ratio=${t}`,{method:"POST"})}async deleteMedia(e){return this.request(`/media/${e}`,{method:"DELETE"})}async getConversations(e){return this.request(`/messages/conversations/${e}`)}async getMessageHistory(e,t,s=50){let a=new URLSearchParams({limit:String(s)});return t&&a.set("conversation_id",t),this.request(`/messages/history/${e}?${a}`)}async getTemplates(){return this.request("/messages/templates")}async createTemplate(e){return this.request("/messages/templates",{method:"POST",body:JSON.stringify(e)})}async deleteTemplate(e){return this.request(`/messages/templates/${e}`,{method:"DELETE"})}async getAutoReplyRules(){return this.request("/messages/auto-reply")}async createAutoReplyRule(e){return this.request("/messages/auto-reply",{method:"POST",body:JSON.stringify(e)})}async deleteAutoReplyRule(e){return this.request(`/messages/auto-reply/${e}`,{method:"DELETE"})}async startDownload(e){return this.request("/downloads/start",{method:"POST",body:JSON.stringify(e)})}async getDownloadStatus(e){return this.request(`/downloads/status/${e}`)}async stopDownload(e){return this.request(`/downloads/stop/${e}`,{method:"POST"})}async getHashtagGroups(e){let t=e?`?account_id=${e}`:"";return this.request(`/hashtags${t}`)}async createHashtagGroup(e){return this.request("/hashtags",{method:"POST",body:JSON.stringify(e)})}async updateHashtagGroup(e,t){return this.request(`/hashtags/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteHashtagGroup(e){return this.request(`/hashtags/${e}`,{method:"DELETE"})}async getSettings(){return this.request("/settings")}async updateSettings(e){return this.request("/settings",{method:"POST",body:JSON.stringify({settings:e})})}async getBackups(){return this.request("/dashboard/backups")}async createBackup(){return this.request("/dashboard/backups/create",{method:"POST"})}};e.s(["api",0,s])},15570,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(9165);function r(){let[e,r]=(0,s.useState)([]),[n,i]=(0,s.useState)(null),[l,c]=(0,s.useState)([]),[o,d]=(0,s.useState)([]),[h,m]=(0,s.useState)(null),[u,p]=(0,s.useState)([]),[y,g]=(0,s.useState)([]),[x,j]=(0,s.useState)("chats"),[v,b]=(0,s.useState)(!0),[f,N]=(0,s.useState)({name:"",content:"",category:"general",shortcut:""}),[S,k]=(0,s.useState)({keywords:"",response:"",match_type:"contains",whatsapp_redirect:""});(0,s.useEffect)(()=>{a.api.getAccounts().then(e=>{r(e||[]),e.length>0&&i(e[0].id),b(!1)}),T(),q()},[]),(0,s.useEffect)(()=>{n&&w()},[n]);let w=async()=>{if(n)try{let e=await a.api.getConversations(n);c(e.conversations||[])}catch{c([])}},_=async e=>{if(n){m(e);try{let t=await a.api.getMessageHistory(n,e);d(t.messages||[])}catch{d([])}}},T=async()=>{try{let e=await a.api.getTemplates();p(e.templates||[])}catch{}},q=async()=>{try{let e=await a.api.getAutoReplyRules();g(e.rules||[])}catch{}},$=async()=>{try{await a.api.createTemplate(f),N({name:"",content:"",category:"general",shortcut:""}),T()}catch(e){alert(e.message)}},O=async()=>{try{await a.api.createAutoReplyRule({...S,keywords:S.keywords.split(",").map(e=>e.trim()),account_id:n}),k({keywords:"",response:"",match_type:"contains",whatsapp_redirect:""}),q()}catch(e){alert(e.message)}};return v?(0,t.jsx)("div",{className:"flex-center",style:{height:"60vh"},children:(0,t.jsx)("div",{className:"spinner"})}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"page-header__title",children:"Mesaj YÃ¶netimi"}),(0,t.jsx)("p",{className:"page-header__subtitle",children:"DM konuÅŸmalarÄ± ve otomatik yanÄ±tlar"})]}),(0,t.jsx)("select",{className:"form-select",style:{width:200},value:n||"",onChange:e=>i(Number(e.target.value)),children:e.map(e=>(0,t.jsxs)("option",{value:e.id,children:["@",e.username]},e.id))})]}),(0,t.jsxs)("div",{className:"tabs",children:[(0,t.jsx)("div",{className:`tab ${"chats"===x?"active":""}`,onClick:()=>j("chats"),children:"ðŸ’¬ KonuÅŸmalar"}),(0,t.jsxs)("div",{className:`tab ${"templates"===x?"active":""}`,onClick:()=>j("templates"),children:["ðŸ“‹ Åžablonlar ",(0,t.jsx)("span",{className:"tab-count",children:u.length})]}),(0,t.jsxs)("div",{className:`tab ${"auto-reply"===x?"active":""}`,onClick:()=>j("auto-reply"),children:["ðŸ¤– Otomatik YanÄ±t ",(0,t.jsx)("span",{className:"tab-count",children:y.length})]})]}),"chats"===x&&(0,t.jsxs)("div",{className:"chat-layout",children:[(0,t.jsx)("div",{className:"chat-list",children:0===l.length?(0,t.jsxs)("div",{className:"empty-state",style:{padding:30},children:[(0,t.jsx)("div",{className:"empty-state__icon",children:"ðŸ’¬"}),(0,t.jsx)("div",{className:"empty-state__title",style:{fontSize:"0.85rem"},children:"KonuÅŸma yok"})]}):l.map((e,s)=>(0,t.jsxs)("div",{className:`chat-list__item ${h===e.id?"active":""}`,onClick:()=>_(e.id),children:[(0,t.jsx)("div",{className:"chat-avatar",children:e.username?.[0]?.toUpperCase()||"?"}),(0,t.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,t.jsx)("div",{style:{fontWeight:600,fontSize:"0.85rem"},children:e.username||"Anonim"}),(0,t.jsx)("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.last_message||"..."})]}),e.unread>0&&(0,t.jsx)("span",{className:"nav-badge",children:e.unread})]},s))}),(0,t.jsx)("div",{className:"chat-messages",children:(0,t.jsx)("div",{className:"chat-messages__body",children:0===o.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("div",{className:"empty-state__icon",children:"ðŸ‘ˆ"}),(0,t.jsx)("div",{className:"empty-state__title",children:"Bir konuÅŸma seÃ§in"})]}):(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:o.map(e=>(0,t.jsxs)("div",{className:`message-bubble ${e.is_incoming?"incoming":"outgoing"}`,children:[e.content,(0,t.jsxs)("div",{className:"message-time",children:[new Date(e.timestamp).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}),e.auto_replied&&" ðŸ¤–"]})]},e.id))})})})]}),"templates"===x&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"card",style:{marginBottom:20},children:[(0,t.jsx)("h4",{style:{marginBottom:12,fontSize:"0.9rem",fontWeight:600},children:"Yeni Åžablon"}),(0,t.jsxs)("div",{className:"row-2",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Åžablon AdÄ±"}),(0,t.jsx)("input",{className:"form-input",placeholder:"Ã¶rn: HoÅŸgeldiniz mesajÄ±",value:f.name,onChange:e=>N({...f,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"KÄ±sayol"}),(0,t.jsx)("input",{className:"form-input",placeholder:"Ã¶rn: /hosgeldin",value:f.shortcut,onChange:e=>N({...f,shortcut:e.target.value})})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Ä°Ã§erik"}),(0,t.jsx)("textarea",{className:"form-input",rows:3,placeholder:"Merhaba! MesajÄ±nÄ±z iÃ§in teÅŸekkÃ¼rler...",value:f.content,onChange:e=>N({...f,content:e.target.value})})]}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:$,children:"âž• Åžablon Ekle"})]}),0===u.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("div",{className:"empty-state__icon",children:"ðŸ“‹"}),(0,t.jsx)("div",{className:"empty-state__title",children:"HenÃ¼z ÅŸablon oluÅŸturulmadÄ±"})]}):(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:12},children:u.map(e=>(0,t.jsxs)("div",{className:"card",style:{padding:16},children:[(0,t.jsxs)("div",{className:"flex-between",style:{marginBottom:8},children:[(0,t.jsx)("strong",{style:{fontSize:"0.9rem"},children:e.name}),(0,t.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>a.api.deleteTemplate(e.id).then(T),children:"ðŸ—‘ï¸"})]}),(0,t.jsx)("p",{style:{fontSize:"0.82rem",color:"var(--text-secondary)"},children:e.content}),(0,t.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8},children:[e.shortcut&&(0,t.jsx)("span",{className:"badge badge-primary",children:e.shortcut}),(0,t.jsxs)("span",{className:"badge badge-info",children:[e.use_count,"Ã— kullanÄ±ldÄ±"]})]})]},e.id))})]}),"auto-reply"===x&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"card",style:{marginBottom:20},children:[(0,t.jsx)("h4",{style:{marginBottom:12,fontSize:"0.9rem",fontWeight:600},children:"Yeni Kural"}),(0,t.jsxs)("div",{className:"row-2",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Anahtar Kelimeler (virgÃ¼lle ayÄ±rÄ±n)"}),(0,t.jsx)("input",{className:"form-input",placeholder:"fiyat, kaÃ§ tl, ne kadar",value:S.keywords,onChange:e=>k({...S,keywords:e.target.value})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"EÅŸleÅŸme TÃ¼rÃ¼"}),(0,t.jsxs)("select",{className:"form-select",value:S.match_type,onChange:e=>k({...S,match_type:e.target.value}),children:[(0,t.jsx)("option",{value:"contains",children:"Ä°Ã§erir"}),(0,t.jsx)("option",{value:"exact",children:"Tam EÅŸleÅŸme"}),(0,t.jsx)("option",{value:"starts_with",children:"Ä°le BaÅŸlar"})]})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Otomatik YanÄ±t"}),(0,t.jsx)("textarea",{className:"form-input",rows:2,placeholder:"Fiyat bilgisi iÃ§in profilimizdeki linke tÄ±klayÄ±n...",value:S.response,onChange:e=>k({...S,response:e.target.value})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"WhatsApp YÃ¶nlendirme (Opsiyonel)"}),(0,t.jsx)("input",{className:"form-input",placeholder:"905551234567",value:S.whatsapp_redirect,onChange:e=>k({...S,whatsapp_redirect:e.target.value})})]}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:O,children:"âž• Kural Ekle"})]}),0===y.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("div",{className:"empty-state__icon",children:"ðŸ¤–"}),(0,t.jsx)("div",{className:"empty-state__title",children:"HenÃ¼z otomatik yanÄ±t kuralÄ± yok"})]}):(0,t.jsx)("div",{className:"table-container",children:(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Anahtar Kelimeler"}),(0,t.jsx)("th",{children:"YanÄ±t"}),(0,t.jsx)("th",{children:"TÃ¼r"}),(0,t.jsx)("th",{children:"WhatsApp"}),(0,t.jsx)("th",{children:"Tetiklenme"}),(0,t.jsx)("th",{})]})}),(0,t.jsx)("tbody",{children:y.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:e.keywords?.map((e,s)=>(0,t.jsx)("span",{className:"badge badge-primary",children:e},s))})}),(0,t.jsx)("td",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.response}),(0,t.jsx)("td",{children:(0,t.jsx)("span",{className:"badge badge-info",children:e.match_type})}),(0,t.jsx)("td",{children:e.whatsapp_redirect?`ðŸ“± ${e.whatsapp_redirect}`:"â€”"}),(0,t.jsxs)("td",{children:[e.trigger_count,"Ã—"]}),(0,t.jsx)("td",{children:(0,t.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>a.api.deleteAutoReplyRule(e.id).then(q),children:"ðŸ—‘ï¸"})})]},e.id))})]})})]})]})}e.s(["default",()=>r])}]);